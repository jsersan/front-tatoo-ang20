<!-- src/app/components/product/product-popup/product-popup.component.html -->

<!-- Overlay para el fondo oscurecido -->
<div class="product-overlay" [class.active]="currentProduct !== null"></div>

<!-- Contenedor principal del popup -->
<div class="product-popup" [class.active]="currentProduct !== null">
  <!-- Solo mostrar contenido si hay un producto seleccionado -->
  <ng-container *ngIf="currentProduct">
    <!-- Cabecera del popup con título y botón de cierre -->
    <div class="product-header">
      <h2>{{ currentProduct.nombre }}</h2>
      <button class="close-product" (click)="closePopup()" aria-label="Cerrar ventana">&times;</button>
    </div>
    
    <!-- Contenido del popup -->
    <div class="product-content">
      <!-- Imagen del producto -->
      <div class="product-image-container">
        <img 
          [src]="getImagePath()" 
          [alt]="currentProduct.nombre"
          class="product-image"
        />
        
        <!-- Indicador de colores disponibles -->
        <div class="colors-indicator" *ngIf="availableColors.length > 0">
          <small>{{ getColorsMessage() }}</small>
        </div>
      </div>
      
      <!-- Detalles del producto -->
      <div class="product-details">
        <!-- Precio -->
        <div class="product-price">
          {{ currentProduct.precio | currency:'EUR':'symbol':'1.2-2' }}
        </div>
        
        <!-- Descripción -->
        <p class="product-description">{{ currentProduct.descripcion }}</p>
        
        <!-- Selector de color solo si hay múltiples colores -->
        <div class="color-selector" *ngIf="hasMultipleColors()">
          <label for="color-select">Selecciona un color:</label>
          <select 
            id="color-select" 
            [(ngModel)]="selectedColor"
            (ngModelChange)="onColorChange()">
            <option *ngFor="let color of availableColors" [value]="color">
              {{ color | titlecase }}
            </option>
          </select>
        </div>
        
        <!-- Mostrar color único si solo hay uno -->
        <div class="single-color-display" *ngIf="!hasMultipleColors() && availableColors.length > 0">
          <label>Color:</label>
          <span class="color-badge">{{ selectedColor | titlecase }}</span>
        </div>
        
        <!-- Selector de cantidad -->
        <div class="quantity-selector">
          <label>Cantidad:</label>
          <div class="quantity-controls">
            <button 
              type="button" 
              class="quantity-btn" 
              (click)="decrementQuantity()"
              [disabled]="quantity <= 1"
              aria-label="Disminuir">
              −
            </button>
            <input 
              type="number" 
              [(ngModel)]="quantity" 
              min="1" 
              max="99"
              class="quantity-input"
              readonly>
            <button 
              type="button" 
              class="quantity-btn" 
              (click)="incrementQuantity()"
              aria-label="Aumentar">
              +
            </button>
          </div>
        </div>
        
        <!-- Botón de añadir al carrito -->
        <button 
          class="add-to-cart-btn" 
          (click)="addToCart()"
          [disabled]="loading || !currentProduct">
          <span *ngIf="!loading">AÑADIR AL CARRITO</span>
          <span *ngIf="loading">CARGANDO...</span>
        </button>
      </div>
    </div>
  </ng-container>
</div>


